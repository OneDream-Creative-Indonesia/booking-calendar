<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snap Fun - Photobox Booking</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/6.1.8/index.global.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: calc(100vh - 40px);
            background: white;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 15px 0;
            border-bottom: 2px solid #f0f8ff;
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            color: #2563eb;
            text-shadow: 2px 2px 4px rgba(37, 99, 235, 0.2);
        }

        .back-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #666;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #f1f5f9;
            color: #2563eb;
        }

        .settings-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #666;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .settings-btn:hover {
            background: #f1f5f9;
        }

        .progress-bar {
            flex: 1;
            max-width: 300px;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            margin: 0 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2563eb, #1d4ed8);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Section visibility */
        .section {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Page Styles */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .service-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 16px;
            padding: 24px;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
            flex-direction:column;
        }

        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #2563eb, #1d4ed8);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .service-card:hover::before {
            transform: scaleX(1);
        }

        .service-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.15);
            border-color: #2563eb;
        }

        .service-card.selected {
            border-color: #2563eb;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            transform: translateY(-2px);
        }

        .service-content {
            flex: 1;
            margin-right: 20px;
        }

        .service-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .service-title {
            font-size: 20px;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 4px;
        }
        .service-description {
            color: #64748b;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .service-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .feature-tag {
            background: #f1f5f9;
            color: #475569;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .feature-tag.highlight {
            background: #dcfce7;
            color: #166534;
        }

        .elephant-icon {
            width: 200px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .elephant-svg {
            width: 200px;
            height: 200px;
            transition: transform 0.3s ease;
        }

        .service-card:hover .elephant-svg {
            transform: scale(1.1) rotate(5deg);
        }

        /* Detail Page Styles */
        .detail-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .service-info {
            border-radius: 16px;
            padding: 30px;
            position: relative;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.08);
        }

        .service-info h2 {
            color: #2563eb;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .info-list {
            list-style: none;
            margin-bottom: 20px;
        }

        .info-list li {
            color: #475569;
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
            font-size: 14px;
            line-height: 1.6;
        }

        .info-list li:before {
            content: "✓";
            color: #2563eb;
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .elephant-detail {
            position: absolute;
            bottom: 16px;
            right: 16px;
            width: 250px;
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .background-section {
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.08);
        }

        .background-section h3 {
            color: #2563eb;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .background-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .background-option {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #e91e63, #ad1457);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 3px solid transparent;
            box-shadow: 0 2px 8px rgba(233, 30, 99, 0.15);
            position: relative;
        }

        .background-option::after {
            content: '';
            position: absolute;
            inset: 4px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }

        .background-option:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.25);
        }

        .background-option.selected {
            border-color: #2563eb;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .continue-btn {
            width: 100%;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(37, 99, 235, 0.15);
        }

        .continue-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(37, 99, 235, 0.25);
        }

        .continue-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Calendar Page Styles */
        .calendar-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .month-navigation {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-btn {
            background: #f1f5f9;
            border: none;
            font-size: 18px;
            color: #475569;
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #e2e8f0;
            color: #2563eb;
        }

        .month-year {
            font-size: 18px;
            font-weight: bold;
            color: #1e293b;
            min-width: 180px;
            text-align: center;
        }

        .calendar-container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-header-cell {
            text-align: center;
            font-weight: bold;
            color: #64748b;
            padding: 12px 0;
            font-size: 14px;
        }

        .calendar-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .calendar-cell:hover {
            background: #f0f8ff;
            color: #2563eb;
        }

        .calendar-cell.selected {
            background: #2563eb;
            color: white;
            transform: scale(1.1);
        }

        .calendar-cell.other-month {
            color: #cbd5e1;
        }

        .calendar-cell.today {
            background: #dbeafe;
            color: #2563eb;
            font-weight: bold;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                background: white;
            }

            .container {
                padding: 15px;
                background: white;
            }

            .header {
                margin-bottom: 20px;
                padding: 10px 0;
            }

            .logo {
                font-size: 24px;
            }

            .progress-bar {
                max-width: 150px;
                margin: 0 15px;
            }

            .services-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .service-card {
                padding: 20px;
                flex-direction: column;
                text-align: left;
            }

            .service-content {
                margin-right: 0;
                margin-bottom: 15px;
                width: 100%;
            }

            .service-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .service-title {
                font-size: 18px;
            }

            .elephant-icon {
                width: 120px;
                height: 120px;
            }

            .elephant-svg {
                width: 120px;
                height: 120px;
            }
            .elephant-detail {
                bottom: 16px;
                right: 16px;
                width: 120px;
                height: 120px;
            }
            .detail-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .service-info,
            .background-section {
                padding: 20px;
            }

            .background-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .calendar-grid {
                gap: 4px;
            }

            .calendar-cell {
                font-size: 12px;
            }

            .month-year {
                font-size: 16px;
                min-width: 150px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .service-card {
                padding: 15px;
            }

            .service-title {
                font-size: 16px;
            }

            .service-description {
                font-size: 13px;
            }

            .background-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Home Section -->
    <div id="home" class="section active">
        <div class="container">
            <div class="header">
                <div class="logo">Snap Fun</div>
            </div>

            <div class="services-grid" id="servicesGrid">
                <!-- Services will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Detail Section -->
    <div id="detail" class="section">
        <div class="container">
            <div class="header">
                <button class="back-btn" onclick="goBack()">&larr;</button>
                <div class="logo">Snap Fun</div>
            </div>

            <div class="detail-content">
                <div class="service-info">
                    <h2 id="detailTitle">Snap Photobox</h2>
                    <ul class="info-list" id="detailFeatures">
                        <!-- Features will be populated by JavaScript -->
                    </ul>
                    <div class="elephant-detail">
                        <svg width="694" height="662" viewBox="0 0 347 331" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M330.699 323.507C325.405 322.696 327.595 313.123 328.953 309.978C322.23 323.563 313.151 324.346 316.672 306.596C309.353 321.201 301.425 318.168 305.112 302.137C310.712 231.544 296.573 197.568 221.349 199.426C219.006 186.946 216.858 174.423 214.751 161.886C318.654 149.308 348.4 221.914 341.58 311.725C340.402 317.204 335.981 324.332 330.699 323.521V323.507Z" fill="#1759CA"/>
<path d="M17.063 76.3662C22.358 77.1768 20.1679 86.7505 18.8095 89.8952C25.5322 76.3103 34.6113 75.5276 31.0905 93.2774C38.4092 78.6723 46.3378 81.7051 42.6507 97.7358C37.0508 168.33 51.1892 202.306 126.414 200.447C128.756 212.928 130.905 225.45 133.012 237.987C29.1084 250.566 -0.637645 177.959 6.18204 88.1482C7.36024 82.6695 11.7819 75.5416 17.063 76.3522V76.3662Z" fill="#1759CA"/>
<path d="M266.702 330.132H211.216V221.411H252.204V302.277L271.083 317.595C276.211 321.76 273.287 330.118 266.702 330.118V330.132Z" fill="#1759CA"/>
<path d="M122.602 330.132H178.047V221.411H137.087V302.277L118.222 317.595C113.093 321.76 116.018 330.118 122.602 330.118V330.132Z" fill="#1759CA"/>
<path d="M266.702 330.132H211.216V274.73H252.204V302.277L271.083 317.595C276.211 321.76 273.287 330.118 266.702 330.118V330.132Z" fill="#0C4FAF"/>
<path d="M178.047 274.73V330.132H122.602C116.018 330.132 113.093 321.774 118.222 317.609L137.087 302.291V274.744H178.047V274.73Z" fill="#0C4FAF"/>
<path d="M282.49 141.956C299.983 157.065 313.719 176.492 321.995 198.546C329.341 218.141 315.161 239.119 294.383 239.119H92.9668C72.1889 239.119 58.009 218.141 65.3554 198.546C73.6305 176.505 87.3669 157.065 104.86 141.956C74.0879 127.337 62.6802 95.4016 58.5912 70.3003C55.6249 52.0754 69.8464 35.6114 88.1708 35.835L193.682 37.0929H296.961C316.464 37.0929 330.893 55.8629 325.501 74.7727C317.975 101.202 302.755 124.472 282.49 141.97V141.956Z" fill="#1759CA"/>
<path d="M282.49 141.956C299.983 157.065 313.719 176.492 321.995 198.546C329.341 218.141 315.161 239.119 294.383 239.119H92.9668C72.1889 239.119 58.009 218.141 65.3554 198.546C73.6305 176.505 87.3669 157.065 104.86 141.956C74.0879 127.337 62.6802 95.4016 58.5912 70.3003C55.6249 52.0754 69.8464 35.6114 88.1708 35.835L193.682 37.0929H296.961C316.464 37.0929 330.893 55.8629 325.501 74.7727C317.975 101.202 302.755 124.472 282.49 141.97V141.956Z" fill="#1759CA"/>
<path d="M214.751 145.912C205.408 145.912 197.84 138.28 197.84 128.861C197.84 119.441 205.408 111.81 214.751 111.81C224.093 111.81 231.661 119.441 231.661 128.861C231.661 138.28 224.093 145.912 214.751 145.912Z" fill="white"/>
<path d="M215 139.468C206.905 139.468 200.321 132.83 200.321 124.668C200.321 123.13 201.569 121.872 203.094 121.872C204.618 121.872 205.866 123.13 205.866 124.668C205.866 129.741 209.955 133.878 215 133.878C220.046 133.878 224.135 129.741 224.135 124.668C224.135 123.13 225.382 121.872 226.907 121.872C228.432 121.872 229.679 123.13 229.679 124.668C229.679 132.83 223.095 139.468 215 139.468Z" fill="#231F20"/>
<path d="M170.076 145.912C160.734 145.912 153.166 138.28 153.166 128.861C153.166 119.441 160.734 111.81 170.076 111.81C179.419 111.81 186.987 119.441 186.987 128.861C186.987 138.28 179.419 145.912 170.076 145.912Z" fill="white"/>
<path d="M169.661 139.468C161.566 139.468 154.982 132.83 154.982 124.668C154.982 123.13 156.229 121.872 157.754 121.872C159.279 121.872 160.526 123.13 160.526 124.668C160.526 129.741 164.629 133.878 169.661 133.878C174.692 133.878 178.795 129.741 178.795 124.668C178.795 123.13 180.043 121.872 181.567 121.872C183.092 121.872 184.339 123.13 184.339 124.668C184.339 132.83 177.755 139.468 169.661 139.468Z" fill="#231F20"/>
<path d="M248.406 171.586C239.063 171.586 231.495 163.955 231.495 154.535C231.495 145.115 239.063 137.484 248.406 137.484C257.748 137.484 265.316 145.115 265.316 154.535C265.316 163.955 257.748 171.586 248.406 171.586Z" fill="#0C4FAF"/>
<path d="M136.366 171.586C127.024 171.586 119.456 163.955 119.456 154.535C119.456 145.115 127.024 137.484 136.366 137.484C145.709 137.484 153.277 145.115 153.277 154.535C153.277 163.955 145.709 171.586 136.366 171.586Z" fill="#0C4FAF"/>
<path d="M217.62 169.671C217.62 171.013 217.537 172.327 217.371 173.612C215.652 187.211 205.131 197.665 192.421 197.665C187.708 197.665 183.3 196.226 179.53 193.724C172.156 188.846 167.221 179.902 167.221 169.671C167.221 154.213 178.504 141.677 192.421 141.677C206.337 141.677 217.62 154.213 217.62 169.671Z" fill="#231F20"/>
<path d="M217.371 173.612C215.652 187.211 205.131 197.665 192.421 197.665C187.708 197.665 183.3 196.226 179.53 193.724C181.249 180.125 191.755 169.671 204.48 169.671C209.193 169.671 213.6 171.111 217.371 173.612Z" fill="#CE004F"/>
<path d="M56.706 0V41.9705C56.706 48.0083 51.8546 52.8999 45.8665 52.8999C39.8785 52.8999 35.0271 48.0083 35.0271 41.9705C35.0271 35.9328 39.8785 31.0411 45.8665 31.0411C47.017 31.0411 48.1259 31.2228 49.1655 31.5583V19.1754L21.6788 26.3451V41.9845C21.6788 48.0222 16.8274 52.9139 10.8394 52.9139C4.8514 52.9139 0 48.0222 0 41.9845C0 35.9468 4.8514 31.0551 10.8394 31.0551C11.9899 31.0551 13.0988 31.2368 14.1384 31.5722V12.6764L56.706 0Z" fill="white"/>
<path d="M347 118.756V151.097C347 155.751 343.258 159.525 338.642 159.525C334.026 159.525 330.283 155.751 330.283 151.097C330.283 146.443 334.026 142.669 338.642 142.669C339.529 142.669 340.388 142.809 341.178 143.075V133.529L319.999 139.049V151.097C319.999 155.751 316.256 159.525 311.64 159.525C307.024 159.525 303.282 155.751 303.282 151.097C303.282 146.443 307.024 142.669 311.64 142.669C312.527 142.669 313.387 142.809 314.177 143.075V128.511L346.986 118.742L347 118.756Z" fill="white"/>
</svg>

                    </div>
                </div>

                <div class="background-section">
                    <h3>Pilih Background</h3>
                    <div class="background-grid">
                        <div class="background-option" onclick="selectBackground(1)"></div>
                        <div class="background-option" onclick="selectBackground(2)"></div>
                        <div class="background-option" onclick="selectBackground(3)"></div>
                        <div class="background-option" onclick="selectBackground(4)"></div>
                        <div class="background-option" onclick="selectBackground(5)"></div>
                        <div class="background-option" onclick="selectBackground(6)"></div>
                    </div>

                    <button class="continue-btn" id="continueBtn" onclick="goToCalendar()" disabled>
                        Lanjutkan ke Pilih Tanggal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Calendar Section -->
    <div id="calendar" class="section">
        <div class="container">
            <div class="header">
                <button class="back-btn" onclick="goBackToDetail()">&larr;</button>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 60%;"></div>
                </div>
                <button class="settings-btn">⚙️</button>
            </div>

            <div class="calendar-header">
                <div class="month-navigation">
                    <button class="nav-btn" onclick="previousMonth()">&larr;</button>
                    <div class="month-year" id="monthYear">September 2024</div>
                    <button class="nav-btn" onclick="nextMonth()">&rarr;</button>
                </div>
            </div>

            <div class="calendar-container">
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be generated by JavaScript -->
                </div>
            </div>

            <button class="continue-btn" id="bookBtn" onclick="confirmBooking()" disabled style="margin-top: 30px;">
                Konfirmasi Booking
            </button>
        </div>
    </div>

    <script>
        // Mock data based on Package model
        const packages = [
            {
                id: 1,
                title: 'Snap Photobox',
                description: '7 Menit sesi foto photobox untuk 2 orang (Bisa tambahan orang +15k/orang maks. 5 orang)',
                duration_minutes: 7,
                price: 25000,
                extras: [
                    'Untuk 2 orang (Bisa tambahan orang)',
                    '+15k/orang maks. 5 orang',
                    '7 Menit sesi foto photobox',
                    'GRATIS 2 cetak foto',
                    'GRATIS Semua softfile'
                ]
            },
            {
                id: 2,
                title: 'Snap Self Photo',
                description: '10 Menit sesi foto self photo untuk 2 orang (Bisa tambahan orang +10k/orang maks. 4 orang)',
                duration_minutes: 10,
                price: 20000,
                extras: [
                    'Untuk 2 orang (Bisa tambahan orang)',
                    '+10k/orang maks. 4 orang',
                    '10 Menit sesi foto self photo',
                    'GRATIS 1 cetak foto',
                    'GRATIS Semua softfile'
                ]
            },
            {
                id: 3,
                title: 'Snap Portrait Photo',
                description: '15 Menit sesi foto portrait profesional untuk 1-2 orang',
                duration_minutes: 15,
                price: 35000,
                extras: [
                    'Untuk 1-2 orang',
                    '15 Menit sesi foto portrait',
                    'GRATIS 3 cetak foto',
                    'GRATIS Semua softfile',
                    'Professional lighting'
                ]
            }
        ];

        // State management
        let selectedService = null;
        let selectedPackage = null;
        let selectedBackground = 0;
        let selectedDate = null;
        let currentMonth = 8; // September (0-indexed)
        let currentYear = 2024;

        const monthNames = [
            'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
            'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
        ];

        const dayNames = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];

        // Format price to Indonesian Rupiah
        function formatPrice(price) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(price).replace('IDR', '').trim() + 'k';
        }

        // Generate services grid
        function generateServicesGrid() {
            const grid = document.getElementById('servicesGrid');
            grid.innerHTML = '';

            packages.forEach(pkg => {
                const card = document.createElement('div');
                card.className = 'service-card';
                card.onclick = () => selectService(pkg);

                // Split description into main description and features
                const features = pkg.extras.slice(0, 3); // Show first 3 features as tags

                card.innerHTML = `
                    <div class="service-content">
                        <div class="service-header">
                            <div class="service-title">${pkg.title}</div>
                        </div>
                        <div class="service-description">${pkg.description}</div>
                        <div class="service-features">
                            ${features.map(feature =>
                                `<span class="feature-tag ${feature.includes('GRATIS') ? 'highlight' : ''}">${feature}</span>`
                            ).join('')}
                        </div>
                    </div>
                    <div class="elephant-icon">
                       <svg width="694" height="662" viewBox="0 0 347 331" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M330.699 323.507C325.405 322.696 327.595 313.123 328.953 309.978C322.23 323.563 313.151 324.346 316.672 306.596C309.353 321.201 301.425 318.168 305.112 302.137C310.712 231.544 296.573 197.568 221.349 199.426C219.006 186.946 216.858 174.423 214.751 161.886C318.654 149.308 348.4 221.914 341.58 311.725C340.402 317.204 335.981 324.332 330.699 323.521V323.507Z" fill="#1759CA"/>
<path d="M17.063 76.3662C22.358 77.1768 20.1679 86.7505 18.8095 89.8952C25.5322 76.3103 34.6113 75.5276 31.0905 93.2774C38.4092 78.6723 46.3378 81.7051 42.6507 97.7358C37.0508 168.33 51.1892 202.306 126.414 200.447C128.756 212.928 130.905 225.45 133.012 237.987C29.1084 250.566 -0.637645 177.959 6.18204 88.1482C7.36024 82.6695 11.7819 75.5416 17.063 76.3522V76.3662Z" fill="#1759CA"/>
<path d="M266.702 330.132H211.216V221.411H252.204V302.277L271.083 317.595C276.211 321.76 273.287 330.118 266.702 330.118V330.132Z" fill="#1759CA"/>
<path d="M122.602 330.132H178.047V221.411H137.087V302.277L118.222 317.595C113.093 321.76 116.018 330.118 122.602 330.118V330.132Z" fill="#1759CA"/>
<path d="M266.702 330.132H211.216V274.73H252.204V302.277L271.083 317.595C276.211 321.76 273.287 330.118 266.702 330.118V330.132Z" fill="#0C4FAF"/>
<path d="M178.047 274.73V330.132H122.602C116.018 330.132 113.093 321.774 118.222 317.609L137.087 302.291V274.744H178.047V274.73Z" fill="#0C4FAF"/>
<path d="M282.49 141.956C299.983 157.065 313.719 176.492 321.995 198.546C329.341 218.141 315.161 239.119 294.383 239.119H92.9668C72.1889 239.119 58.009 218.141 65.3554 198.546C73.6305 176.505 87.3669 157.065 104.86 141.956C74.0879 127.337 62.6802 95.4016 58.5912 70.3003C55.6249 52.0754 69.8464 35.6114 88.1708 35.835L193.682 37.0929H296.961C316.464 37.0929 330.893 55.8629 325.501 74.7727C317.975 101.202 302.755 124.472 282.49 141.97V141.956Z" fill="#1759CA"/>
<path d="M282.49 141.956C299.983 157.065 313.719 176.492 321.995 198.546C329.341 218.141 315.161 239.119 294.383 239.119H92.9668C72.1889 239.119 58.009 218.141 65.3554 198.546C73.6305 176.505 87.3669 157.065 104.86 141.956C74.0879 127.337 62.6802 95.4016 58.5912 70.3003C55.6249 52.0754 69.8464 35.6114 88.1708 35.835L193.682 37.0929H296.961C316.464 37.0929 330.893 55.8629 325.501 74.7727C317.975 101.202 302.755 124.472 282.49 141.97V141.956Z" fill="#1759CA"/>
<path d="M214.751 145.912C205.408 145.912 197.84 138.28 197.84 128.861C197.84 119.441 205.408 111.81 214.751 111.81C224.093 111.81 231.661 119.441 231.661 128.861C231.661 138.28 224.093 145.912 214.751 145.912Z" fill="white"/>
<path d="M215 139.468C206.905 139.468 200.321 132.83 200.321 124.668C200.321 123.13 201.569 121.872 203.094 121.872C204.618 121.872 205.866 123.13 205.866 124.668C205.866 129.741 209.955 133.878 215 133.878C220.046 133.878 224.135 129.741 224.135 124.668C224.135 123.13 225.382 121.872 226.907 121.872C228.432 121.872 229.679 123.13 229.679 124.668C229.679 132.83 223.095 139.468 215 139.468Z" fill="#231F20"/>
<path d="M170.076 145.912C160.734 145.912 153.166 138.28 153.166 128.861C153.166 119.441 160.734 111.81 170.076 111.81C179.419 111.81 186.987 119.441 186.987 128.861C186.987 138.28 179.419 145.912 170.076 145.912Z" fill="white"/>
<path d="M169.661 139.468C161.566 139.468 154.982 132.83 154.982 124.668C154.982 123.13 156.229 121.872 157.754 121.872C159.279 121.872 160.526 123.13 160.526 124.668C160.526 129.741 164.629 133.878 169.661 133.878C174.692 133.878 178.795 129.741 178.795 124.668C178.795 123.13 180.043 121.872 181.567 121.872C183.092 121.872 184.339 123.13 184.339 124.668C184.339 132.83 177.755 139.468 169.661 139.468Z" fill="#231F20"/>
<path d="M248.406 171.586C239.063 171.586 231.495 163.955 231.495 154.535C231.495 145.115 239.063 137.484 248.406 137.484C257.748 137.484 265.316 145.115 265.316 154.535C265.316 163.955 257.748 171.586 248.406 171.586Z" fill="#0C4FAF"/>
<path d="M136.366 171.586C127.024 171.586 119.456 163.955 119.456 154.535C119.456 145.115 127.024 137.484 136.366 137.484C145.709 137.484 153.277 145.115 153.277 154.535C153.277 163.955 145.709 171.586 136.366 171.586Z" fill="#0C4FAF"/>
<path d="M217.62 169.671C217.62 171.013 217.537 172.327 217.371 173.612C215.652 187.211 205.131 197.665 192.421 197.665C187.708 197.665 183.3 196.226 179.53 193.724C172.156 188.846 167.221 179.902 167.221 169.671C167.221 154.213 178.504 141.677 192.421 141.677C206.337 141.677 217.62 154.213 217.62 169.671Z" fill="#231F20"/>
<path d="M217.371 173.612C215.652 187.211 205.131 197.665 192.421 197.665C187.708 197.665 183.3 196.226 179.53 193.724C181.249 180.125 191.755 169.671 204.48 169.671C209.193 169.671 213.6 171.111 217.371 173.612Z" fill="#CE004F"/>
<path d="M56.706 0V41.9705C56.706 48.0083 51.8546 52.8999 45.8665 52.8999C39.8785 52.8999 35.0271 48.0083 35.0271 41.9705C35.0271 35.9328 39.8785 31.0411 45.8665 31.0411C47.017 31.0411 48.1259 31.2228 49.1655 31.5583V19.1754L21.6788 26.3451V41.9845C21.6788 48.0222 16.8274 52.9139 10.8394 52.9139C4.8514 52.9139 0 48.0222 0 41.9845C0 35.9468 4.8514 31.0551 10.8394 31.0551C11.9899 31.0551 13.0988 31.2368 14.1384 31.5722V12.6764L56.706 0Z" fill="white"/>
<path d="M347 118.756V151.097C347 155.751 343.258 159.525 338.642 159.525C334.026 159.525 330.283 155.751 330.283 151.097C330.283 146.443 334.026 142.669 338.642 142.669C339.529 142.669 340.388 142.809 341.178 143.075V133.529L319.999 139.049V151.097C319.999 155.751 316.256 159.525 311.64 159.525C307.024 159.525 303.282 155.751 303.282 151.097C303.282 146.443 307.024 142.669 311.64 142.669C312.527 142.669 313.387 142.809 314.177 143.075V128.511L346.986 118.742L347 118.756Z" fill="white"/>
</svg>

                    </div>
                `;

                grid.appendChild(card);
            });
        }

        // Navigation functions
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        function selectService(pkg) {
            selectedService = pkg.title;
            selectedPackage = pkg;

            // Update detail page with selected package data
            document.getElementById('detailTitle').textContent = pkg.title;

            const featuresList = document.getElementById('detailFeatures');
            featuresList.innerHTML = '';
            pkg.extras.forEach(extra => {
                const li = document.createElement('li');
                li.textContent = extra;
                featuresList.appendChild(li);
            });

            showSection('detail');
            saveToStorage();
        }

        function goBack() {
            showSection('home');
        }

        function goBackToDetail() {
            showSection('detail');
        }

        function selectBackground(bgNumber) {
            // Remove previous selection
            document.querySelectorAll('.background-option').forEach(option => {
                option.classList.remove('selected');
            });

            // Add selection to clicked option
            event.target.classList.add('selected');
            selectedBackground = bgNumber;

            // Enable continue button
            document.getElementById('continueBtn').disabled = false;
            saveToStorage();
        }

        function goToCalendar() {
            showSection('calendar');
            generateCalendar();
        }

        // Calendar functions
        function generateCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';

            // Update month/year display
            document.getElementById('monthYear').textContent = `${monthNames[currentMonth]} ${currentYear}`;

            // Add day headers
            dayNames.forEach(day => {
                const headerCell = document.createElement('div');
                headerCell.className = 'calendar-header-cell';
                headerCell.textContent = day;
                grid.appendChild(headerCell);
            });

            // Get first day of month and number of days
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();

            // Add previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell other-month';
                cell.textContent = daysInPrevMonth - i;
                grid.appendChild(cell);
            }

            // Add current month days
           // Add current month days
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell';
                cell.textContent = day;

                // Check if it's today
                if (currentYear === today.getFullYear() &&
                    currentMonth === today.getMonth() &&
                    day === today.getDate()) {
                    cell.classList.add('today');
                }

                // Make clickable for future dates only
                const cellDate = new Date(currentYear, currentMonth, day);
                if (cellDate >= today || (cellDate.toDateString() === today.toDateString())) {
                    cell.onclick = () => selectDate(day);
                } else {
                    cell.style.opacity = '0.3';
                    cell.style.cursor = 'not-allowed';
                }

                grid.appendChild(cell);
            }

            // Add next month days to fill the grid
            const totalCells = grid.children.length;
            const remainingCells = 42 - totalCells; // 6 weeks * 7 days
            for (let day = 1; day <= remainingCells; day++) {
                const cell = document.createElement('div');
                cell.className = 'calendar-cell other-month';
                cell.textContent = day;
                grid.appendChild(cell);
            }
        }

        function selectDate(day) {
            // Remove previous selection
            document.querySelectorAll('.calendar-cell.selected').forEach(cell => {
                cell.classList.remove('selected');
            });

            // Add selection to clicked date
            event.target.classList.add('selected');
            selectedDate = new Date(currentYear, currentMonth, day);

            // Show time selection and generate time slots
            showTimeSection();
            generateTimeSlots();

            // Reset time selection
            selectedTime = null;
            document.getElementById('bookBtn').disabled = true;

            saveToStorage();
        }

        function showTimeSection() {
            document.getElementById('timeSection').classList.add('active');
        }

        function hideTimeSection() {
            document.getElementById('timeSection').classList.remove('active');
        }

        function generateTimeSlots() {
            const timeGrid = document.getElementById('timeGrid');
            timeGrid.innerHTML = '';

            if (!selectedPackage) return;

            // Get package duration and calculate intervals
            const packageDuration = selectedPackage.duration_minutes;
            const intervalMinutes = Math.max(packageDuration, 30); // Minimum 30 minutes interval

            // Generate time slots from 9 AM to 6 PM
            const startHour = 9;
            const endHour = 18;
            const slots = [];

            for (let hour = startHour; hour < endHour; hour++) {
                for (let minute = 0; minute < 60; minute += intervalMinutes) {
                    const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const endTime = new Date();
                    endTime.setHours(hour, minute + packageDuration, 0, 0);

                    // Don't add slot if it would end after closing time
                    if (endTime.getHours() <= endHour) {
                        slots.push({
                            time: timeString,
                            display: `${timeString} - ${endTime.getHours().toString().padStart(2, '0')}:${endTime.getMinutes().toString().padStart(2, '0')}`,
                            available: Math.random() > 0.3 // Mock availability - replace with real data from backend
                        });
                    }
                }
            }

            availableTimeSlots = slots;

            // Create time slot elements
            slots.forEach((slot, index) => {
                const timeSlot = document.createElement('div');
                timeSlot.className = `time-slot ${slot.available ? '' : 'unavailable'}`;
                timeSlot.innerHTML = `
                    <div style="font-weight: bold;">${slot.time}</div>
                    <div style="font-size: 11px; opacity: 0.8;">${packageDuration}min</div>
                `;

                if (slot.available) {
                    timeSlot.onclick = () => selectTime(index, slot);
                }

                timeGrid.appendChild(timeSlot);
            });
        }

        function selectTime(index, slot) {
            // Remove previous selection
            document.querySelectorAll('.time-slot.selected').forEach(timeSlot => {
                timeSlot.classList.remove('selected');
            });

            // Add selection to clicked time slot
            event.currentTarget.classList.add('selected');
            selectedTime = slot;

            // Enable booking button
            document.getElementById('bookBtn').disabled = false;

            saveToStorage();
        }

        function previousMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateCalendar();
            hideTimeSection();
            selectedDate = null;
            selectedTime = null;
            document.getElementById('bookBtn').disabled = true;
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateCalendar();
            hideTimeSection();
            selectedDate = null;
            selectedTime = null;
            document.getElementById('bookBtn').disabled = true;
        }

        function confirmBooking() {
            if (selectedPackage && selectedBackground && selectedDate && selectedTime) {
                const bookingData = {
                    package: selectedPackage,
                    background: selectedBackground,
                    date: selectedDate.toLocaleDateString('id-ID'),
                    time: selectedTime.time,
                    duration: selectedPackage.duration_minutes,
                    timestamp: new Date().toISOString()
                };

                // Store booking data
                localStorage.setItem('latestBooking', JSON.stringify(bookingData));

                alert(`Booking berhasil!\n\nPaket: ${selectedPackage.title}\nBackground: ${selectedBackground}\nTanggal: ${selectedDate.toLocaleDateString('id-ID')}\nWaktu: ${selectedTime.time}\nDurasi: ${selectedPackage.duration_minutes} menit\nHarga: ${formatPrice(selectedPackage.price)}`);

                // Reset and go back to home
                resetBooking();
                showSection('home');
            } else {
                alert('Silakan pilih tanggal dan waktu terlebih dahulu!');
            }
        }

        function resetBooking() {
            selectedService = null;
            selectedPackage = null;
            selectedBackground = 0;
            selectedDate = null;
            selectedTime = null;

            // Reset UI
            document.querySelectorAll('.service-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelectorAll('.background-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelectorAll('.calendar-cell').forEach(cell => {
                cell.classList.remove('selected');
            });
            document.querySelectorAll('.time-slot').forEach(slot => {
                slot.classList.remove('selected');
            });

            hideTimeSection();
            document.getElementById('continueBtn').disabled = true;
            document.getElementById('bookBtn').disabled = true;

            clearStorage();
        }

        // Storage functions
        function saveToStorage() {
            const state = {
                selectedService,
                selectedPackage,
                selectedBackground,
                selectedDate: selectedDate ? selectedDate.toISOString() : null,
                selectedTime,
                currentMonth,
                currentYear
            };
            sessionStorage.setItem('snapFunState', JSON.stringify(state));
        }

        function loadFromStorage() {
            const stored = sessionStorage.getItem('snapFunState');
            if (stored) {
                const state = JSON.parse(stored);
                selectedService = state.selectedService;
                selectedPackage = state.selectedPackage;
                selectedBackground = state.selectedBackground;
                selectedDate = state.selectedDate ? new Date(state.selectedDate) : null;
                selectedTime = state.selectedTime;
                currentMonth = state.currentMonth || 8;
                currentYear = state.currentYear || 2024;
            }
        }

        function clearStorage() {
            sessionStorage.removeItem('snapFunState');
        }

        // Initialize app
        function initApp() {
            loadFromStorage();
            generateServicesGrid();

            // Restore state if exists
            if (selectedPackage) {
                document.getElementById('detailTitle').textContent = selectedPackage.title;
                const featuresList = document.getElementById('detailFeatures');
                featuresList.innerHTML = '';
                selectedPackage.extras.forEach(extra => {
                    const li = document.createElement('li');
                    li.textContent = extra;
                    featuresList.appendChild(li);
                });
            }

            if (selectedBackground > 0) {
                const bgOptions = document.querySelectorAll('.background-option');
                if (bgOptions[selectedBackground - 1]) {
                    bgOptions[selectedBackground - 1].classList.add('selected');
                    document.getElementById('continueBtn').disabled = false;
                }
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initApp();

            // Handle back button browser navigation
            window.addEventListener('popstate', function(e) {
                if (e.state && e.state.section) {
                    showSection(e.state.section);
                }
            });

            // Auto-save state on page unload
            window.addEventListener('beforeunload', function() {
                saveToStorage();
            });
        });

        // Add smooth transitions between sections
        function showSection(sectionId) {
            const currentSection = document.querySelector('.section.active');
            const targetSection = document.getElementById(sectionId);

            if (currentSection) {
                currentSection.style.opacity = '0';
                setTimeout(() => {
                    currentSection.classList.remove('active');
                    targetSection.classList.add('active');
                    targetSection.style.opacity = '0';
                    setTimeout(() => {
                        targetSection.style.opacity = '1';
                    }, 50);
                }, 150);
            } else {
                targetSection.classList.add('active');
            }

            // Update browser history
            history.pushState({section: sectionId}, '', `#${sectionId}`);
        }

        // Add touch support for mobile
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                const currentSection = document.querySelector('.section.active');

                if (currentSection.id === 'detail' && diff > 0) {
                    // Swipe left to go to calendar
                    if (selectedBackground > 0) {
                        goToCalendar();
                    }
                } else if (currentSection.id === 'calendar' && diff < 0) {
                    // Swipe right to go back to detail
                    goBackToDetail();
                } else if (currentSection.id === 'detail' && diff < 0) {
                    // Swipe right to go back to home
                    goBack();
                }
            }
        }

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            const currentSection = document.querySelector('.section.active');

            if (e.key === 'Escape') {
                if (currentSection.id === 'calendar') {
                    goBackToDetail();
                } else if (currentSection.id === 'detail') {
                    goBack();
                }
            } else if (e.key === 'Enter') {
                if (currentSection.id === 'detail' && selectedBackground > 0) {
                    goToCalendar();
                } else if (currentSection.id === 'calendar' && selectedDate) {
                    confirmBooking();
                }
            }
        });
    </script>
</body>
</html>
